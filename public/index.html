<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <title>암호기</title>
</head>
<body>
    <style>
        h3, h2, h4 {
            text-align: center;
        }
    </style>
    <div style="display: flex; justify-content: space-between;">
        <div>
            <form method="get" action="">
                복호화 : <input type="radio" name="crypto" class="crypto" value="decrypt" checked/>
                암호화 : <input type="radio" name="crypto" class="crypto" value="encrypt" /> <br />
                Base64 : <input type="radio" name="mode" onclick="none()" value="7" checked /> <br />
                2진법 : <input type="radio" name="mode" onclick="none()" value="1" /> <br />
                8진법 : <input type="radio" name="mode" onclick="none()" value="2" /> <br />
                16진법 : <input type="radio" name="mode" onclick="none()" value="3" /> <br />
                32진법 : <input type="radio" name="mode" onclick="none()" value="4" /> <br />
                DES : <input type="radio" name="mode" onclick="block()" value="5" /> <br />
                AES : <input type="radio" name="mode" onclick="block()" value="6" /> <br />
                모스 부호 : <input type="radio" name="mode" onclick="none()" value="8" /> <br />
                <textarea placeholder="text" name="content" style="width: 345px; height: 160px;"></textarea> <br />
                <input type="text" name="key" id="key" placeholder="key" style="display: none;"/> <br />
                <input type="button" onclick="clicked()" value="결과값 보기">
            </form>
            <button onclick="go()" id="go" style="display: none;" />해독된 사이트로 이동하기</button>
            <br />
            <textarea id="output" style="width: 345px; height: 160px;"></textarea>
            <input type="hidden" id="links" value="" />
        </div>
        <div>
            <ins class="kakao_ad_area" style="display:none;" 
            data-ad-unit    = "DAN-syFi3Fo8XsmlzdSW" 
            data-ad-width   = "160" 
            data-ad-height  = "600"></ins> 
        </div>
    </div>
    <hr />
        <h2>-update-</h2>
        <h4>21-09-26 : 이제 띄어쓰기가 없는 진수의 복호화일 경우에도 해독을 해줍니다.</h4>
        <h4>21-10-21 : 광고 최소화 및 위치 이동</h4>
        <h4>21-10-27 : 댓글창 개설 원하는 추가 기능 등을 적어주세요!</h4>
        <h4>21-12-01 : 댓글창 표시</h4>
    <hr />
        <h2>-다음 업뎃 예고-</h2>
        <h4>시험 주간이라 좀 걸리겠지만</h4>
        <h4>다음은 라이브 모드</h4>
        <h4>링크(http)가 아닐시 다시 디코딩 하기</h4>
    <hr />
    
    <textarea id="reply" placeholder="개발자에게 보내고 싶은 말을 적어주세요." style='width:"800px"; height:"400px";'></textarea>
    <input type="button" value="보내기" onclick="replySend()" id="replyBtn" />
    <img src="https://t1.daumcdn.net/cfile/blog/9971254B5E3A670916" style="display: none;" id="loadingImg" width="50px" height="50px">
    <br><hr><br>
    <div id="replyArea"></div>
    <script type="text/javascript" src="//t1.daumcdn.net/kas/static/ba.min.js" async></script>
    <script>
        window.onload = () => {
            showReply()
        }
        
        function showReply() {
            let root = document.getElementById("replyArea")
            root.innerHTML = ""
            
            $.ajax({
                url: "http://koldin.myddns.me:4002/reply",
                method: "get",
                success: data => {
                    
                    console.log(data)
                    
                    // if(data == ) {
                    //     return root.innerHTML += "<p>error;;</p>"
                    // }
                    
                    for(_data of data) {
                        root.innerHTML += `
                        <li>${_data.description}-${_data.created}</li>
                        `
                    }
                }
            })
        }
    
        function replySend() {
            const reply = document.querySelector('#reply')
            const replyBtn = document.querySelector("#replyBtn")
            const loadingImg = document.querySelector("#loadingImg").style
            const replyData = reply.value
            
            loadingImg.display = "block"
            reply.style.display = "none"
            replyBtn.style.display = "none"
            
            $.ajax({
                url: "http://koldin.myddns.me:4002/reply",
                method: "post",
                data: {
                    reply: replyData
                },
                success: () => {
                }
            })
            
            setTimeout(() => {
                reply.style.display = "block"
                replyBtn.style.display = "block"
                loadingImg.display = "none"
                showReply()
            }, 3000)
        }
        
        function block() {
            const key = document.querySelector('#key')
            key.style.display = "block"
        }
        function none() {
            const key = document.querySelector('#key')
            key.style.display = "none"
        }
        function clicked() {
            const
                crypto = document.querySelector('input[name="crypto"]:checked').value,
                mode = document.querySelector('input[name="mode"]:checked').value,
                content = document.querySelector("textarea[name='content']").value,
                key = document.querySelector("#key").value || ''

            $.ajax({
                url: 'http://koldin.myddns.me:4002/value',
                type: 'post',
                data:{
                    key : key,
                    content : content,
                    mode : mode,
                    crypto : crypto

                },
                success: (result) => {
                    if(result.slice(0, 4) == "http") {
                        document.querySelector("#links").value = result
                        document.querySelector("#go").style.display = 'block'
                    } else {
                        document.querySelector("#go").style.display = 'none'
                    }
                    document.querySelector("#output").value = result
                }
            })
        }

        function go() {
            window.open(
                document.querySelector("#links").value,
                '_blank'
            )
        }
    </script>
</body>
</html>